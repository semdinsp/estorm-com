selectRCPerDM[dm_String, rows_List] := 
  Module[{mds}, mds = selectPattern[rows, {_, _, dm, __}]; mds];
selectIncrement[rows_List] :=  
  Module[{res}, res = selectPattern[rows, {"increment", __}]; res];
getLatestRCPerDM[dm_String, releasecashes_List] := 
  Module[{res}, res = selectRCPerDM[dm, releasecashes];
   If[Length[res] == 0, $Failed, First[res]]];
checkIfOldReleaseCash[dm_String, releasecashes_List] := 
  Module[{latestRC, rcdate},
   latestRC = getLatestRCPerDM[dm, releasecashes];
   rcdate = DateObject[{2006, 12}];
   If[Head[latestRC] == List, rcdate = DateObject[latestRC[[13]]]];
    If[DateDifference[rcdate, DateObject[]] > Quantity[8, "days"], 
    True, False]];
{day, rows, allrows, month} = getWalletRows[]; rowsLowBalance = 
 Select[rows, #[[1]] < 0.75* #[[6]] &];
r = getReleaseCash[]; r = r[[3 ;;]]; r = 
 selectIncrement[r]; inactiveWallets = 
 Map[If[checkIfOldReleaseCash[ToString[#[[2]]], 
     r], {#[[1]], #[[2]], #[[4]] }, Nothing] &, rowsLowBalance];
grid = Grid[
   Prepend[{#[[1]], #[[2]], #[[3]]} & /@ 
     inactiveWallets, {"Wallet Balance",   "MD", "DM"}], Frame -> All,
    Background -> {None, {LightBlue, {LightYellow}}}];
frags = {Style[
    StringJoin["Wallets with No cash release in 8 days: ", 
     DateString[]], Blue], grid};
cc = {"eka.mardiarti@estormtech.com", "scott.sproule@estormtech.com", 
   "henricos@estormtech.com", "belo@estormtech.com"};

estormAWSSendEmail[{"emiliana@estormtech.com"}, cc, {}, 
  "Wallets Needing Release Cash", combineHTMLFragments[frags]];
  
Quit[];