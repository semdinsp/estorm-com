Needs["dmdash`"]; 
Needs["dreamUtilities`"];
{day, rows, allrows, month} = getWalletRows[];
vals = createDMAssociation[day, rows, allrows];
grid = dmdash`dmAvailableCredit[
   Select[rows, #[[7]] > 0.5 && #[[1]]/(#[[7]]/day) < 2 &], day] ;
grid2 = dmdash`dmWalletReview[rows];
grid3 = dmdash`dmAvailableCredit[rows, day] ;
allwallets = dmdash`allWallets[allrows];
cc = {"eka.mardiarti@estormtech.com", "henricos@estormtech.com", 
   "emiliana@estormtech.com", "helio@estormtech.com", 
   "scott.sproule@estormtech.com"};
to = {"belo@estormtech.com", "antonio.quelo@estormtech.com", 
   "miki@estormtech.com", "joao@estormtech.com", "ldecosta@estormtech.com",
   "tsantos@estormtech.com"};
fragments = {Style[
    StringJoin["Immediate action required: ", DateString[]], Blue], 
   grid, Style["Low balance", Blue], grid2, 
   Style["All wallets cash days left", Blue], grid3,Style["All wallets Balance", Blue], allwallets, closingData[]};
estormAWSSendEmail[to, cc, {}, "Wallets Requiring Action", 
 combineHTMLFragments[fragments]];
Quit[];
